

#include <katsu/kt.h>
#include <stdio.h>


/*Test Sprite Palette*/
const u32 spr_palette[16] = {
	0x408080, 0x2F2F2F, 0x5F5F5F, 0x9F9F9F, 0xDFDFDF, 0xFFFFFF,
	0x085242, 0x188E10, 0x7BCE31, 0xC6E79C, 0x000060, 0x00399C,
	0x527BDE, 0xB5C6F7, 0xF1F0FF, 0x000000
};

/*Test Sprite Tiles*/
const u8 spr_tiles[] =
{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x32, 0x33, 0x00, 0x20, 0x43, 0x55, 0x03,
    0x21, 0x43, 0x55, 0x24, 0x21, 0x33, 0x44, 0x23,
    0x2f, 0x32, 0x33, 0x13, 0x1f, 0x22, 0x22, 0x12,
    0xf0, 0x21, 0x22, 0x01, 0x00, 0xff, 0xff, 0x00,
    0x00, 0x60, 0x77, 0x77, 0x00, 0x76, 0x88, 0x99,
    0x60, 0x86, 0x76, 0x77, 0x76, 0x78, 0x76, 0x77,
    0x86, 0x87, 0x66, 0x66, 0x86, 0x6f, 0x79, 0x66,
    0x86, 0xff, 0x98, 0x59, 0x76, 0x68, 0x88, 0x88,
    0x77, 0x77, 0x06, 0x00, 0x99, 0x88, 0x67, 0x00,
    0x77, 0x67, 0x68, 0x06, 0x77, 0x67, 0x87, 0x67,
    0x66, 0x66, 0x78, 0x68, 0x66, 0x97, 0xf6, 0x68,
    0x95, 0x89, 0xff, 0x68, 0x88, 0x88, 0x86, 0x67,
    0xf0, 0x68, 0x87, 0x88, 0xf0, 0x78, 0x77, 0x88,
    0x00, 0x8f, 0x77, 0x88, 0x00, 0xf0, 0x7f, 0x77,
    0x00, 0x00, 0x6f, 0x77, 0x00, 0x00, 0xf0, 0x77,
    0x00, 0x00, 0xff, 0x86, 0x00, 0x00, 0xf0, 0xff,
    0x88, 0x78, 0x86, 0x0f, 0x88, 0x77, 0x87, 0x0f,
    0x88, 0x77, 0xf8, 0x00, 0x77, 0xf7, 0x0f, 0x00,
    0x77, 0xf6, 0x00, 0x00, 0x77, 0x0f, 0x00, 0x00,
    0x68, 0xff, 0x00, 0x00, 0xff, 0x0f, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xcc,
    0x00, 0x00, 0xd0, 0xee, 0x00, 0x00, 0x5d, 0xee,
    0x00, 0xc0, 0xe5, 0xee, 0x00, 0xc0, 0xe5, 0xee,
    0x00, 0xc0, 0x55, 0xee, 0x00, 0xdb, 0x55, 0x55,
    0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,
    0xce, 0x0c, 0x00, 0x00, 0xee, 0xbe, 0x00, 0x00,
    0xee, 0xee, 0x0a, 0x00, 0xe5, 0xee, 0xae, 0x00,
    0x55, 0xe5, 0xde, 0x0a, 0x55, 0xe5, 0xce, 0x0b,
    0x00, 0xeb, 0x55, 0x55, 0xb0, 0xec, 0x5e, 0x55,
    0xeb, 0xec, 0xee, 0x55, 0xeb, 0xed, 0xde, 0xee,
    0x5b, 0xed, 0xed, 0xee, 0xeb, 0xde, 0xed, 0x55,
    0x5b, 0xde, 0x5c, 0xde, 0x5a, 0xe5, 0xec, 0xdd,
    0xe5, 0x5e, 0xcd, 0xac, 0x55, 0xe5, 0xcc, 0xac,
    0xe5, 0xcd, 0xbc, 0xac, 0xdd, 0xcc, 0xbb, 0xfc,
    0xce, 0xcc, 0xbb, 0xfb, 0xde, 0xdc, 0xbd, 0xfb,
    0xdd, 0xee, 0xdd, 0xfb, 0xed, 0xee, 0xde, 0xfd,
    0xda, 0xd5, 0xee, 0xdd, 0xda, 0x5c, 0x55, 0xcc,
    0xda, 0xdc, 0xcc, 0xcc, 0xca, 0xcd, 0xcc, 0xbc,
    0xcf, 0xcd, 0xcc, 0xbc, 0xaf, 0xcd, 0xcc, 0xbc,
    0xf0, 0xcb, 0xcc, 0xab, 0x00, 0xff, 0xff, 0xff,
    0xec, 0xee, 0xcd, 0xfd, 0xdc, 0xce, 0xcc, 0xfb,
    0xdc, 0xcd, 0xcc, 0xfb, 0xcb, 0xcd, 0xcb, 0xfb,
    0xbb, 0xcc, 0xbb, 0xfa, 0xbb, 0xcb, 0xfc, 0x0f,
    0xfa, 0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00
};

unsigned char test_4bpp[] = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
  0x00, 0x00, 0x00, 0x21, 0x00, 0x00, 0x10, 0x22, 0x00, 0x00, 0x10, 0x22,
  0x00, 0x00, 0x10, 0x11, 0x00, 0x10, 0x31, 0x33, 0x00, 0x31, 0x33, 0x33,
  0x11, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x12, 0x22, 0x22, 0x22, 0x22,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x11, 0x00, 0x00, 0x00,
  0x33, 0x11, 0x00, 0x00, 0x33, 0x33, 0x01, 0x00, 0x33, 0x33, 0x13, 0x00,
  0x32, 0x33, 0x33, 0x01, 0x21, 0x33, 0x33, 0x11, 0x12, 0x22, 0x22, 0x11,
  0x12, 0x11, 0x22, 0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x21, 0x22,
  0x00, 0x10, 0x11, 0x22, 0x00, 0x21, 0x33, 0x21, 0x00, 0x31, 0x53, 0x23,
  0x00, 0x31, 0x52, 0x25, 0x00, 0x31, 0x32, 0x23, 0x00, 0x31, 0x31, 0x23,
  0x00, 0x31, 0x31, 0x23, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x11, 0x11, 0x22, 0x11, 0x33, 0x13,
  0x12, 0x31, 0x55, 0x25, 0x12, 0x52, 0x55, 0x52, 0x11, 0x52, 0x55, 0x12,
  0x12, 0x52, 0x55, 0x13, 0x12, 0x52, 0x33, 0x13, 0x12, 0x32, 0x33, 0x13,
  0x21, 0x11, 0x11, 0x11, 0x11, 0x22, 0x22, 0x11, 0x11, 0x21, 0x12, 0x13,
  0x41, 0x22, 0x13, 0x55, 0x41, 0x44, 0x11, 0x55, 0x12, 0x00, 0x00, 0x00,
  0x12, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00,
  0x12, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00,
  0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11,
  0x00, 0x10, 0x11, 0x33, 0x10, 0x31, 0x33, 0x33, 0x21, 0x22, 0x33, 0x33,
  0x21, 0x22, 0x22, 0x11, 0x21, 0x22, 0x22, 0x22, 0x21, 0x22, 0x22, 0x22,
  0x10, 0x21, 0x33, 0x21, 0x31, 0x13, 0x11, 0x21, 0x33, 0x33, 0x13, 0x22,
  0x33, 0x33, 0x13, 0x22, 0x33, 0x33, 0x33, 0x21, 0x22, 0x33, 0x33, 0x13,
  0x11, 0x11, 0x33, 0x33, 0x21, 0x22, 0x31, 0x33, 0x41, 0x52, 0x55, 0x12,
  0x41, 0x34, 0x55, 0x25, 0x41, 0x44, 0x55, 0x55, 0x42, 0x44, 0x44, 0x44,
  0x42, 0x44, 0x44, 0x44, 0x22, 0x44, 0x12, 0x21, 0x11, 0x42, 0x44, 0x24,
  0x33, 0x21, 0x44, 0x44, 0x41, 0x44, 0x11, 0x55, 0x45, 0x44, 0x25, 0x55,
  0x44, 0x44, 0x54, 0x45, 0x44, 0x24, 0x44, 0x24, 0x44, 0x44, 0x44, 0x14,
  0x44, 0x44, 0x44, 0x31, 0x42, 0x44, 0x24, 0x33, 0x44, 0x44, 0x32, 0x33,
  0x11, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x10,
  0x01, 0x00, 0x10, 0x21, 0x11, 0x11, 0x11, 0x22, 0x33, 0x33, 0x21, 0x22,
  0x33, 0x33, 0x21, 0x22, 0x33, 0x33, 0x21, 0x22, 0x00, 0x00, 0x00, 0x00,
  0x10, 0x11, 0x11, 0x01, 0x21, 0x22, 0x22, 0x12, 0x32, 0x33, 0x23, 0x22,
  0x33, 0x33, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
  0x22, 0x22, 0x22, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x01, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x12, 0x01, 0x00, 0x00,
  0x31, 0x12, 0x00, 0x00, 0x32, 0x11, 0x00, 0x00, 0x22, 0x11, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x22, 0x22, 0x22,
  0x10, 0x22, 0x22, 0x22, 0x00, 0x21, 0x22, 0x22, 0x00, 0x10, 0x22, 0x22,
  0x00, 0x00, 0x11, 0x22, 0x00, 0x00, 0x10, 0x22, 0x00, 0x00, 0x00, 0x21,
  0x00, 0x00, 0x00, 0x10, 0x22, 0x22, 0x11, 0x33, 0x22, 0x12, 0x11, 0x33,
  0x22, 0x22, 0x12, 0x33, 0x22, 0x22, 0x12, 0x33, 0x22, 0x22, 0x12, 0x33,
  0x22, 0x22, 0x21, 0x33, 0x22, 0x12, 0x32, 0x33, 0x11, 0x21, 0x22, 0x33,
  0x33, 0x13, 0x41, 0x44, 0x33, 0x33, 0x23, 0x22, 0x33, 0x33, 0x33, 0x33,
  0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33,
  0x33, 0x33, 0x33, 0x23, 0x33, 0x33, 0x22, 0x22, 0x44, 0x22, 0x33, 0x33,
  0x22, 0x33, 0x33, 0x33, 0x33, 0x33, 0x23, 0x11, 0x33, 0x33, 0x11, 0x00,
  0x33, 0x13, 0x00, 0x00, 0x23, 0x01, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00,
  0x11, 0x00, 0x00, 0x00, 0x33, 0x33, 0x21, 0x22, 0x11, 0x11, 0x11, 0x22,
  0x00, 0x00, 0x10, 0x21, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22,
  0x21, 0x22, 0x22, 0x12, 0x10, 0x11, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x21, 0x12, 0x00, 0x00,
  0x12, 0x01, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
  0x00, 0x00, 0x11, 0x31, 0x00, 0x10, 0x12, 0x33, 0x00, 0x21, 0x22, 0x31,
  0x10, 0x22, 0x22, 0x31, 0x21, 0x22, 0x22, 0x12, 0x10, 0x22, 0x22, 0x22,
  0x31, 0x23, 0x22, 0x22, 0x33, 0x33, 0x22, 0x22, 0x33, 0x33, 0x22, 0x22,
  0x33, 0x33, 0x23, 0x22, 0x33, 0x33, 0x33, 0x22, 0x33, 0x33, 0x23, 0x11,
  0x33, 0x33, 0x11, 0x00, 0x33, 0x33, 0x23, 0x12, 0x22, 0x12, 0x11, 0x31,
  0x22, 0x22, 0x22, 0x33, 0x22, 0x22, 0x32, 0x33, 0x22, 0x22, 0x33, 0x33,
  0x22, 0x32, 0x33, 0x33, 0x11, 0x11, 0x21, 0x11, 0x00, 0x00, 0x11, 0x22,
  0x11, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x33, 0x01, 0x00, 0x00,
  0x33, 0x13, 0x00, 0x00, 0x33, 0x21, 0x01, 0x00, 0x11, 0x22, 0x01, 0x00,
  0x22, 0x22, 0x12, 0x00, 0x22, 0x22, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
  0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x11, 0x22, 0x00, 0x10, 0x22, 0x22,
  0x00, 0x21, 0x22, 0x22, 0x10, 0x22, 0x22, 0x22, 0x10, 0x22, 0x22, 0x22,
  0x10, 0x11, 0x11, 0x11, 0x22, 0x22, 0x22, 0x12, 0x22, 0x22, 0x22, 0x22,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x12, 0x22, 0x22, 0x22, 0x12,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x11, 0x11, 0x11, 0x11,
  0x33, 0x13, 0x00, 0x00, 0x31, 0x01, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00,
  0x11, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x21, 0x22,
  0x00, 0x10, 0x22, 0x22, 0x00, 0x11, 0x22, 0x22, 0x00, 0x21, 0x22, 0x22,
  0x10, 0x22, 0x22, 0x22, 0x10, 0x22, 0x22, 0x22, 0x10, 0x22, 0x22, 0x22,
  0x10, 0x11, 0x11, 0x11, 0x22, 0x22, 0x12, 0x00, 0x22, 0x22, 0x12, 0x00,
  0x22, 0x12, 0x11, 0x01, 0x22, 0x22, 0x22, 0x12, 0x22, 0x22, 0x22, 0x22,
  0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x11, 0x11, 0x11, 0x11,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00,
  0x12, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

unsigned int test_4bpp_len = 1536;

u32 test_pal_PAL[] = {
  0x00808000, 0x00000000, 0x00ec7000,
  0x00f7e25f, 0x00a3d1e1, 0x00fcfcfc,
  0x33333333, 0x33333333, 0x33333333,
  0x33333333, 0x33333333, 0x33333333,
  0x33333333, 0x33333333, 0x33333333,
  0x33333333
};
unsigned int test_pal_PAL_len = 64;


int main() {
	if (kt_Init()) {
		return 0;
	}
	u32 x = 40;
	u32 y = 20;
	Sprite spr[4] = {0};
	kt_TilesetLoad(0, 12, spr_tiles);
	kt_TilesetLoad(12, 48, test_4bpp);
	kt_VideoTitleSet("Test program");
	kt_PaletteLoad(0, 16, spr_palette);
	kt_PaletteLoad(16, 16, test_pal_PAL);

	spr[0].pos = SPR_POS(20, 40);
	spr[0].chr = SPR_CHR(0, 0, SIZE_16, SIZE_24, 0);
	spr[0].sfx = SPR_HUE(0xFFFF, 0x00) | SPR_BLEND(0x80);
	spr[0].mat = 0;

	spr[1].pos = SPR_POS(60, 120);
	spr[1].chr = SPR_CHR(0, 0, SIZE_32, SIZE_16, 0);
	spr[1].sfx = SPR_HUE(0x00FF, 0x00);
	spr[1].mat = 0;

	spr[2].pos = SPR_POS(40, 20);
	spr[2].chr = SPR_CHR(12, 0, SIZE_64, SIZE_48, 1);
	spr[2].sfx = SPR_HUE(0x00FF, 0x00);
	spr[2].mat = 0;

	kt_LayerSprite(1, 3, spr);
	kt_LayerMap(0, LAYER_TYPE_MAP_NORMAL, 15, TILEMAP_SIZE_128x128);
	kt_VideoFrameSet(VIDEO_FRAME_2X);
	kt_TilemapSetChr(0, 4, 4, TMAP_CHR(1, FLIP_NONE, 0));
	kt_TilemapSetChr(0, 5, 4, TMAP_CHR(1, FLIP_Y, 0));
	kt_TilemapSetChr(0, 4, 2, TMAP_CHR(1, FLIP_NONE, 0));
	kt_TilemapSetChr(0, 7, 6, TMAP_CHR(1, FLIP_XY, 0));
	for (int i = 0; i < 64;++i) {
	for (int j = 0; j < 64;++j) {
	kt_TilemapSetChr(1, i, j, TMAP_CHR(15, FLIP_NONE, 1));
	kt_TilemapSetChr(2, i, j, TMAP_CHR(5, FLIP_NONE, 0));
	kt_TilemapSetChr(3, i, j, TMAP_CHR(3, FLIP_NONE, 0));
	}
	}
	while (1) {
		kt_Poll();

		u32 btns = kt_JoyButtonHeld(0);
		x += ((btns >> JOY_BIT_RIGHT) & 0x1) - ((btns >> JOY_BIT_LEFT) & 0x1);
		y += ((btns >> JOY_BIT_DOWN) & 0x1) - ((btns >> JOY_BIT_UP) & 0x1);
		kt_OffsetColor(x - 50, x - 50, y - 50);

		//kt_LayerRect(0, 10, 15, x+30, y+40);
		kt_LayerMapOffset(0, x, y);

		spr[2].pos = SPR_POS(x, y);

		if (kt_JoyButtonHeld(0) & JOY_A) {
			kt_BackColor(0x505050);
		} else {
			kt_BackColor(0x202050);
		}

		kt_Draw();
	}

	return 0;
}
